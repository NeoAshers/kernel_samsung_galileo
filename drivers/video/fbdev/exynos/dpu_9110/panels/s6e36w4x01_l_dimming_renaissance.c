/* drivers/video/fbdev/exynos/dpu_9110/panels/s6e36w4x01_l_dimming_renaissance.c
 *
 * MIPI-DSI based S6E36W4X01 AMOLED panel driver.
 *
 * Taeheon Kim, <th908.kim@samsung.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#include <linux/kernel.h>

#include "s6e36w4x01_dimming.h"
#include "s6e36w4x01_param.h"
#include "s6e36w4x01_mipi_lcd.h"
#include "s6e36w4x01_lcd_ctrl.h"

/*#define SMART_DIMMING_DEBUG*/
#define RGB_COMPENSATION 33

#define MULTIPLE_VREGOUT		6200
#define DOUBLE_MULTIPLE_VREGOUT	6200000

#define LPM_BR_MAX_INDEX		40
#define LPM_BR_NORMAL_INDEX	40
#define LPM_BR_MIN_INDEX		1
#define LPM_BR_CHARGING_INDEX		40

const unsigned char s6e36w4x01_br_tbl[MAX_BRIGHTNESS + 1] = {
	0,
	0, 0, 1, 1, 2, 2, 3, 3, 4, 4,
	5, 5, 6, 6, 7, 7, 8, 8, 9, 9,
	10, 10, 11, 11, 12, 13, 13, 14, 14, 15,
	16, 16, 17, 17, 18, 19, 19, 20, 20, 21,
	22, 22, 23, 23, 24, 25, 25, 26, 26, 27,
	28, 28, 29, 29, 30, 31, 31, 32, 32, 33,
	34, 34, 35, 35, 36, 37, 37, 38, 38, 39,
	40, 40, 41, 42, 43, 43, 44, 45, 45, 46,
	47, 47, 48, 48, 49, 50, 50, 51, 51, 52,
	54, 57, 59, 62, 64, 66, 68, 69, 71, 73,
};

unsigned char s6e36w4x01_gamma_set[MAX_BR_INFO][GAMMA_CMD_CNT];

const unsigned char s6e36w4x01_elvss[MAX_BR_INFO] = {
	0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
	0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
	0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
	0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
	0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0E,
	0x0E, 0x0D, 0x0D, 0x0C, 0x0C, 0x0C, 0x0B, 0x0B, 0x0B, 0x0B,
	0x0B, 0x0B, 0x0B, 0x0B, 0x0A, 0x0A, 0x0A, 0x09, 0x09, 0x09,
	0x08, 0x08, 0x07, 0x07,
};

const unsigned char s6e36w4x01_aid[MAX_BR_INFO*2] = {
	0x01, 0x53, 0x01, 0x52, 0x01, 0x50, 0x01, 0x4B, 0x01, 0x49,
	0x01, 0x43, 0x01, 0x41, 0x01, 0x3C, 0x01, 0x36, 0x01, 0x32,
	0x01, 0x31, 0x01, 0x2B, 0x01, 0x23, 0x01, 0x22, 0x01, 0x1A,
	0x01, 0x13, 0x01, 0x11, 0x01, 0x09, 0x01, 0x02, 0x00, 0xF9,
	0x00, 0xF1, 0x00, 0xEA, 0x00, 0xE1, 0x00, 0xD4, 0x00, 0xCA,
	0x00, 0xC1, 0x00, 0xB7, 0x00, 0xA9, 0x00, 0x9B, 0x00, 0x9B,
	0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B,
	0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B,
	0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B, 0x00, 0x9B, 0x00, 0x99,
	0x00, 0x8A, 0x00, 0x79, 0x00, 0x69, 0x00, 0x59, 0x00, 0x4C,
	0x00, 0x4C, 0x00, 0x4C, 0x00, 0x4C, 0x00, 0x4C, 0x00, 0x4C,
	0x00, 0x4C, 0x00, 0x4C, 0x00, 0x4B, 0x00, 0x43, 0x00, 0x41,
	0x00, 0x3A, 0x00, 0x32, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30,
	0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30,
	0x00, 0x30, 0x00, 0x30, 0x00, 0x30, 0x00, 0x30,
};

static const unsigned char MAX_GAMMA_SET[GAMMA_CMD_CNT] = {
	0xCA,
	0x07, 0x00, 0x00,
	0x00, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x80, 0x80,
	0x80, 0x00, 0x00,
	0x00,
};

static unsigned int ref_gamma[NUM_VREF][CI_MAX] = {
	{0x00, 0x00, 0x00},
	{0x80, 0x80, 0x80},
	{0x80, 0x80, 0x80},
	{0x80, 0x80, 0x80},
	{0x80, 0x80, 0x80},
	{0x80, 0x80, 0x80},
	{0x80, 0x80, 0x80},
	{0x80, 0x80, 0x80},
	{0x80, 0x80, 0x80},
	{0x100, 0x100, 0x100},
};

const static int vreg_element_max[NUM_VREF] = {
	0xff,
	0xff,
	0xff,
	0xff,
	0xff,
	0xff,
	0xff,
	0xff,
	0xff,
	0x1ff,
};

const static struct v_constant fix_const[NUM_VREF] = {
	{.nu = 0,	.de = 256},
	{.nu = 64,	.de = 320},
	{.nu = 64,	.de = 320},
	{.nu = 64,	.de = 320},
	{.nu = 64,	.de = 320},
	{.nu = 64,	.de = 320},
	{.nu = 64,	.de = 320},
	{.nu = 64,	.de = 320},
	{.nu = 64,	.de = 320},
	{.nu = 229,	.de = 860},
};

static const int gamma_tbl[256] = {
	0, 7, 31, 75, 138, 224, 331, 461,
	614, 791, 992, 1218, 1468, 1744, 2045, 2372,
	2725, 3105, 3511, 3943, 4403, 4890, 5404, 5946,
	6516, 7114, 7740, 8394, 9077, 9788, 10528, 11297,
	12095, 12922, 13779, 14665, 15581, 16526, 17501, 18507,
	19542, 20607, 21703, 22829, 23986, 25174, 26392, 27641,
	28921, 30232, 31574, 32947, 34352, 35788, 37255, 38754,
	40285, 41847, 43442, 45068, 46727, 48417, 50140, 51894,
	53682, 55501, 57353, 59238, 61155, 63105, 65088, 67103,
	69152, 71233, 73348, 75495, 77676, 79890, 82138, 84418,
	86733, 89080, 91461, 93876, 96325, 98807, 101324, 103874,
	106458, 109075, 111727, 114414, 117134, 119888, 122677, 125500,
	128358, 131250, 134176, 137137, 140132, 143163, 146227, 149327,
	152462, 155631, 158835, 162074, 165348, 168657, 172002, 175381,
	178796, 182246, 185731, 189251, 192807, 196398, 200025, 203688,
	207385, 211119, 214888, 218693, 222533, 226410, 230322, 234270,
	238254, 242274, 246330, 250422, 254550, 258714, 262914, 267151,
	271423, 275732, 280078, 284459, 288878, 293332, 297823, 302351,
	306915, 311516, 316153, 320827, 325538, 330285, 335069, 339890,
	344748, 349643, 354575, 359544, 364549, 369592, 374672, 379789,
	384943, 390134, 395363, 400629, 405932, 411272, 416650, 422065,
	427517, 433007, 438534, 444099, 449702, 455342, 461020, 466735,
	472488, 478279, 484107, 489973, 495878, 501819, 507799, 513817,
	519872, 525966, 532098, 538267, 544475, 550721, 557005, 563327,
	569687, 576085, 582522, 588997, 595510, 602062, 608651, 615280,
	621946, 628652, 635395, 642177, 648998, 655857, 662755, 669691,
	676667, 683680, 690733, 697824, 704954, 712122, 719330, 726576,
	733861, 741186, 748549, 755951, 763391, 770871, 778390, 785948,
	793545, 801182, 808857, 816571, 824325, 832118, 839950, 847821,
	855732, 863682, 871671, 879700, 887768, 895875, 904022, 912208,
	920434, 928699, 937004, 945349, 953733, 962156, 970619, 979122,
	987665, 996247, 1004869, 1013531, 1022233, 1030974, 1039755, 1048576
};

const static int gamma_multi_tbl[256] = {
	0, 3, 14, 34, 64, 105, 157, 220, 296, 383,
	483, 595, 721, 860, 1012, 1178, 1358, 1551, 1759, 1982,
	2218, 2470, 2736, 3017, 3313, 3624, 3951, 4293, 4651, 5024,
	5413, 5818, 6239, 6676, 7129, 7598, 8084, 8586, 9105, 9641,
	10193, 10762, 11348, 11951, 12571, 13208, 13862, 14534, 15223, 15929,
	16653, 17395, 18154, 18931, 19726, 20538, 21369, 22217, 23084, 23968,
	24871, 25792, 26732, 27689, 28665, 29660, 30673, 31705, 32755, 33824,
	34912, 36019, 37144, 38289, 39452, 40635, 41836, 43057, 44297, 45556,
	46834, 48132, 49449, 50785, 52141, 53516, 54911, 56326, 57760, 59214,
	60687, 62180, 63694, 65227, 66780, 68353, 69945, 71558, 73191, 74845,
	76518, 78211, 79925, 81659, 83413, 85188, 86983, 88799, 90635, 92491,
	94368, 96266, 98184, 100123, 102083, 104063, 106065, 108087, 110129, 112193,
	114278, 116383, 118510, 120657, 122826, 125016, 127227, 129459, 131712, 133986,
	136282, 138599, 140937, 143297, 145678, 148080, 150504, 152950, 155416, 157905,
	160415, 162946, 165500, 168075, 170671, 173290, 175930, 178592, 181275, 183981,
	186708, 189458, 192229, 195022, 197837, 200675, 203534, 206415, 209319, 212245,
	215192, 218162, 221155, 224169, 227206, 230265, 233346, 236450, 239576, 242724,
	245895, 249089, 252305, 255543, 258804, 262088, 265394, 268723, 272074, 275448,
	278845, 282264, 285706, 289171, 292659, 296170, 299703, 303259, 306839, 310441,
	314066, 317714, 321385, 325079, 328796, 332536, 336299, 340086, 343895, 347728,
	351584, 355463, 359365, 363291, 367239, 371211, 375207, 379226, 383268, 387333,
	391422, 395534, 399670, 403829, 408012, 412218, 416448, 420702, 424979, 429279,
	433603, 437951, 442323, 446718, 451137, 455580, 460046, 464536, 469050, 473588,
	478150, 482735, 487345, 491978, 496635, 501317, 506022, 510751, 515504, 520281,
	525083, 529908, 534757, 539631, 544528, 549450, 554396, 559366, 564360, 569379,
	574422, 579489, 584580, 589696, 594836, 600000
};

const static int gamma_double_multi_tbl[256] = {
  0, 3046, 13997, 34153, 64312, 105074, 156926, 220282, 295502, 382910,
  482795, 595425, 721044, 859881, 1012149, 1178050, 1357772, 1551495, 1759391, 1981622,
  2218344, 2469706, 2735853, 3016922, 3313047, 3624356, 3950974, 4293022, 4650616, 5023871,
  5412895, 5817797, 6238681, 6675649, 7128801, 7598232, 8084038, 8586312, 9105143, 9640621,
  10192831, 10761860, 11347790, 11950703, 12570679, 13207797, 13862134, 14533765, 15222766, 15929210,
  16653168, 17394712, 18153911, 18930835, 19725550, 20538124, 21368622, 22217108, 23083648, 23968303,
  24871135, 25792206, 26731576, 27689305, 28665452, 29660075, 30673230, 31704975, 32755366, 33824459,
  34912306, 36018964, 37144485, 38288923, 39452328, 40634754, 41836251, 43056869, 44296660, 45555672,
  46833954, 48131555, 49448524, 50784906, 52140751, 53516104, 54911012, 56325520, 57759674, 59213519,
  60687099, 62180458, 63693641, 65226690, 66779649, 68352560, 69945466, 71558408, 73191428, 74844567,
  76517867, 78211367, 79925108, 81659130, 83413472, 85188174, 86983275, 88798814, 90634828, 92491356,
  94368437, 96266106, 98184403, 100123363, 102083024, 104063422, 106064593, 108086573, 110129399, 112193105,
  114277727, 116383300, 118509859, 120657438, 122826071, 125015794, 127226639, 129458640, 131711831, 133986245,
  136281915, 138598875, 140937156, 143296791, 145677812, 148080252, 150504142, 152949514, 155416399, 157904830,
  160414836, 162946449, 165499700, 168074619, 170671237, 173289584, 175929689, 178591584, 181275298, 183980860,
  186708299, 189457646, 192228929, 195022178, 197837420, 200674685, 203534001, 206415397, 209318900, 212244540,
  215192344, 218162339, 221154553, 224169015, 227205751, 230264788, 233346154, 236449876, 239575980, 242724494,
  245895443, 249088855, 252304756, 255543171, 258804128, 262087652, 265393769, 268722505, 272073885, 275447935,
  278844681, 282264147, 285706359, 289171342, 292659121, 296169721, 299703166, 303259481, 306838691, 310440820,
  314065893, 317713933, 321384966, 325079014, 328796101, 332536253, 336299491, 340085841, 343895325, 347727967,
  351583790, 355462818, 359365074, 363290580, 367239360, 371211436, 375206832, 379225571, 383267673, 387333163,
  391422063, 395534395, 399670181, 403829444, 408012205, 412218487, 416448312, 420701701, 424978676, 429279259,
  433603472, 437951336, 442322872, 446718103, 451137048, 455579730, 460046170, 464536389, 469050407, 473588245,
  478149926, 482735468, 487344894, 491978223, 496635477, 501316675, 506021838, 510750987, 515504142, 520281323,
  525082549, 529907843, 534757222, 539630708, 544528320, 549450078, 554396001, 559366110, 564360424, 569378963,
  574421746, 579488792, 584580121, 589695753, 594835706, 600000000,
};

const static unsigned char lookup_tbl[601] = {
	0, 14, 19, 23, 26, 29, 31, 34, 36, 38,
	40, 41, 43, 45, 46, 48, 49, 50, 52, 53,
	54, 56, 57, 58, 59, 60, 61, 62, 63, 64,
	65, 66, 67, 68, 69, 70, 71, 72, 73, 74,
	74, 75, 76, 77, 78, 79, 79, 80, 81, 82,
	82, 83, 84, 85, 85, 86, 87, 87, 88, 89,
	90, 90, 91, 92, 92, 93, 93, 94, 95, 95,
	96, 97, 97, 98, 98, 99, 100, 100, 101, 101,
	102, 103, 103, 104, 104, 105, 105, 106, 107, 107,
	108, 108, 109, 109, 110, 110, 111, 111, 112, 112,
	113, 113, 114, 114, 115, 115, 116, 116, 117, 117,
	118, 118, 119, 119, 120, 120, 121, 121, 122, 122,
	123, 123, 124, 124, 125, 125, 125, 126, 126, 127,
	127, 128, 128, 129, 129, 129, 130, 130, 131, 131,
	132, 132, 132, 133, 133, 134, 134, 135, 135, 135,
	136, 136, 137, 137, 137, 138, 138, 139, 139, 139,
	140, 140, 141, 141, 141, 142, 142, 143, 143, 143,
	144, 144, 145, 145, 145, 146, 146, 146, 147, 147,
	148, 148, 148, 149, 149, 149, 150, 150, 150, 151,
	151, 152, 152, 152, 153, 153, 153, 154, 154, 154,
	155, 155, 155, 156, 156, 157, 157, 157, 158, 158,
	158, 159, 159, 159, 160, 160, 160, 161, 161, 161,
	162, 162, 162, 163, 163, 163, 164, 164, 164, 165,
	165, 165, 166, 166, 166, 167, 167, 167, 167, 168,
	168, 168, 169, 169, 169, 170, 170, 170, 171, 171,
	171, 172, 172, 172, 173, 173, 173, 173, 174, 174,
	174, 175, 175, 175, 176, 176, 176, 176, 177, 177,
	177, 178, 178, 178, 179, 179, 179, 179, 180, 180,
	180, 181, 181, 181, 182, 182, 182, 182, 183, 183,
	183, 184, 184, 184, 184, 185, 185, 185, 186, 186,
	186, 186, 187, 187, 187, 187, 188, 188, 188, 189,
	189, 189, 189, 190, 190, 190, 191, 191, 191, 191,
	192, 192, 192, 192, 193, 193, 193, 194, 194, 194,
	194, 195, 195, 195, 195, 196, 196, 196, 196, 197,
	197, 197, 198, 198, 198, 198, 199, 199, 199, 199,
	200, 200, 200, 200, 201, 201, 201, 201, 202, 202,
	202, 202, 203, 203, 203, 203, 204, 204, 204, 204,
	205, 205, 205, 205, 206, 206, 206, 206, 207, 207,
	207, 207, 208, 208, 208, 208, 209, 209, 209, 209,
	210, 210, 210, 210, 211, 211, 211, 211, 212, 212,
	212, 212, 213, 213, 213, 213, 214, 214, 214, 214,
	214, 215, 215, 215, 215, 216, 216, 216, 216, 217,
	217, 217, 217, 218, 218, 218, 218, 218, 219, 219,
	219, 219, 220, 220, 220, 220, 221, 221, 221, 221,
	221, 222, 222, 222, 222, 223, 223, 223, 223, 224,
	224, 224, 224, 224, 225, 225, 225, 225, 226, 226,
	226, 226, 226, 227, 227, 227, 227, 228, 228, 228,
	228, 228, 229, 229, 229, 229, 230, 230, 230, 230,
	230, 231, 231, 231, 231, 231, 232, 232, 232, 232,
	233, 233, 233, 233, 233, 234, 234, 234, 234, 235,
	235, 235, 235, 235, 236, 236, 236, 236, 236, 237,
	237, 237, 237, 237, 238, 238, 238, 238, 239, 239,
	239, 239, 239, 240, 240, 240, 240, 240, 241, 241,
	241, 241, 241, 242, 242, 242, 242, 242, 243, 243,
	243, 243, 243, 244, 244, 244, 244, 245, 245, 245,
	245, 245, 246, 246, 246, 246, 246, 247, 247, 247,
	247, 247, 248, 248, 248, 248, 248, 249, 249, 249,
	249, 249, 250, 250, 250, 250, 250, 251, 251, 251,
	251, 251, 251, 252, 252, 252, 252, 252, 253, 253,
	253, 253, 253, 254, 254, 254, 254, 254, 255, 255,
	255
};

static const unsigned int vt_trans_volt[16] = {
	6200000, 6113488, 6026976, 5940465, 5853953, 5767441, 5680930, 5594418,
	5507906, 5421395, 5205116, 5133023, 5060930, 4988837, 4916744, 4859069
};

static const unsigned int v0_trans_volt[16] = {
	6200000, 6156744, 6113488, 6070233, 6026977, 5983721, 5940465, 5897209,
	5853953, 5810698, 5767442, 5724186, 5680930, 5637674, 5594419, 5551163
};

static const unsigned int v1_trans_volt [256] = {
	0, 4, 8, 12, 16, 20, 23, 27,
	31, 35, 39, 43, 47,	51,	55, 59,
	63, 66, 70, 74, 78,	82, 86, 90,
	94, 98, 102, 105, 109, 113, 117, 121,
	125, 129, 133, 137, 141, 145, 148, 152,
	156, 160, 164, 168, 172, 176, 180, 184,
	188, 191, 195, 199, 203, 207, 211, 215,
	219, 223, 227, 230, 234, 238, 242, 246,
	250, 254, 258, 262, 266, 270, 273, 277,
	281, 285, 289, 293, 297, 301, 305, 309,
	313, 316, 320, 324, 328, 332, 336, 340,
	344, 348, 352, 355, 359, 363, 367, 371,
	375, 379, 383, 387, 391, 395, 398, 402,
	406, 410, 414, 418, 422, 426, 430, 434,
	438, 441, 445, 449, 453, 457, 461, 465,
	469, 473, 477, 480, 484, 488, 492, 496,
	500, 504, 508, 512, 516, 520, 523, 527,
	531, 535, 539, 543, 547, 551, 555, 559,
	563, 566, 570, 574, 578, 582, 586, 590,
	594, 598, 602, 605, 609, 613, 617, 621,
	625, 629, 633, 637, 641, 645, 648, 652,
	656, 660, 664, 668, 672, 676, 680, 684,
	688, 691, 695, 699, 703, 707, 711, 715,
	719, 723, 727, 730, 734, 738, 742, 746,
	750, 754, 758, 762, 766, 770, 773, 777,
	781, 785, 789, 793, 797, 801, 805, 809,
	813, 816, 820, 824, 828, 832, 836, 840,
	844, 848, 852, 855, 859, 863, 867, 871,
	875, 879, 883, 887, 891, 895, 898, 902,
	906, 910, 914, 918, 922, 926, 930, 934,
	938, 941, 945, 949, 953, 957, 961, 965,
	969, 973, 977, 980, 984, 988, 992, 996,
};

static const unsigned int v203_trans_volt [256] = {
	200, 203, 206, 209, 213, 216, 219, 222,
	225, 228, 231, 234, 238, 241, 244, 247,
	250, 253, 256, 259, 263, 266, 269, 272,
	275, 278, 281, 284, 288, 291, 294, 297,
	300, 303, 306, 309, 313, 316, 319, 322,
	325, 328, 331, 334, 338, 341, 344, 347,
	350, 353, 356, 359, 363, 366, 369, 372,
	375, 378, 381, 384, 388, 391, 394, 397,
	400, 403, 406, 409, 413, 416, 419, 422,
	425, 428, 431, 434, 438, 441, 444, 447,
	450, 453, 456, 459, 463, 466, 469, 472,
	475, 478, 481, 484, 488, 491, 494, 497,
	500, 503, 506, 509, 513, 516, 519, 522,
	525, 528, 531, 534, 538, 541, 544, 547,
	550, 553, 556, 559, 563, 566, 569, 572,
	575, 578, 581, 584, 588, 591, 594, 597,
	600, 603, 606, 609, 613, 616, 619, 622,
	625, 628, 631, 634, 638, 641, 644, 647,
	650, 653, 656, 659, 663, 666, 669, 672,
	675, 678, 681, 684, 688, 691, 694, 697,
	700, 703, 706, 709, 713, 716, 719, 722,
	725, 728, 731, 734, 738, 741, 744, 747,
	750, 753, 756, 759, 763, 766, 769, 772,
	775, 778, 781, 784, 788, 791, 794, 797,
	800, 803, 806, 809, 813, 816, 819, 822,
	825, 828, 831, 834, 838, 841, 844, 847,
	850, 853, 856, 859, 863, 866, 869, 872,
	875, 878, 881, 884, 888, 891, 894, 897,
	900, 903, 906, 909, 913, 916, 919, 922,
	925, 928, 931, 934, 938, 941, 944, 947,
	950, 953, 956, 959, 963, 966, 969, 972,
	975, 978, 981, 984, 988, 991, 994, 997,
};

static const unsigned int v255_trans_volt [513] = {
	4549070, 4541860, 4534651, 4527442, 4520233, 4513023, 4505814, 4498605, 4491395, 4484186,
	4476977, 4469767, 4462558, 4455349, 4448140, 4440930, 4433721, 4426512, 4419302, 4412093,
	4404884, 4397674, 4390465, 4383256, 4376047, 4368837, 4361628, 4354419, 4347209, 4340000,
	4332791, 4325581, 4318372, 4311163, 4303953, 4296744, 4289535, 4282326, 4275116, 4267907,
	4260698, 4253488, 4246279, 4239070, 4231860, 4224651, 4217442, 4210233, 4203023, 4195814,
	4188605, 4181395, 4174186, 4166977, 4159767, 4152558, 4145349, 4138140, 4130930, 4123721,
	4116512, 4109302, 4102093, 4094884, 4087674, 4080465, 4073256, 4066047, 4058837, 4051628,
	4044419, 4037209, 4030000, 4022791, 4015581, 4008372, 4001163, 3993953, 3986744, 3979535,
	3972326, 3965116, 3957907, 3950698, 3943488, 3936279, 3929070, 3921860, 3914651, 3907442,
	3900233, 3893023, 3885814, 3878605, 3871395, 3864186, 3856977, 3849767, 3842558, 3835349,
	3828140, 3820930, 3813721, 3806512, 3799302, 3792093, 3784884, 3777674, 3770465, 3763256,
	3756047, 3748837, 3741628, 3734419, 3727209, 3720000, 3712791, 3705581, 3698372, 3691163,
	3683953, 3676744, 3669535, 3662326, 3655116, 3647907, 3640698, 3633488, 3626279, 3619070,
	3611860, 3604651, 3597442, 3590233, 3583023, 3575814, 3568605, 3561395, 3554186, 3546977,
	3539767, 3532558, 3525349, 3518140, 3510930, 3503721, 3496512, 3489302, 3482093, 3474884,
	3467674, 3460465, 3453256, 3446047, 3438837, 3431628, 3424419, 3417209, 3410000, 3402791,
	3395581, 3388372, 3381163, 3373953, 3366744, 3359535, 3352326, 3345116, 3337907, 3330698,
	3323488, 3316279, 3309070, 3301860, 3294651, 3287442, 3280233, 3273023, 3265814, 3258605,
	3251395, 3244186, 3236977, 3229767, 3222558, 3215349, 3208140, 3200930, 3193721, 3186512,
	3179302, 3172093, 3164884, 3157674, 3150465, 3143256, 3136047, 3128837, 3121628, 3114419,
	3107209, 3100000, 3092791, 3085581, 3078372, 3071163, 3063953, 3056744, 3049535, 3042326,
	3035116, 3027907, 3020698, 3013488, 3006279, 2999070, 2991860, 2984651, 2977442, 2970233,
	2963023, 2955814, 2948605, 2941395, 2934186, 2926977, 2919767, 2912558, 2905349, 2898140,
	2890930, 2883721, 2876512, 2869302, 2862093, 2854884, 2847674, 2840465, 2833256, 2826047,
	2818837, 2811628, 2804419, 2797209, 2790000, 2782791, 2775581, 2768372, 2761163, 2753953,
	2746744, 2739535, 2732326, 2725116, 2717907, 2710698, 2703488, 2696279, 2689070, 2681860,
	2674651, 2667442, 2660233, 2653023, 2645814, 2638605, 2631395, 2624186, 2616977, 2609767,
	2602558, 2595349, 2588140, 2580930, 2573721, 2566512, 2559302, 2552093, 2544884, 2537674,
	2530465, 2523256, 2516047, 2508837, 2501628, 2494419, 2487209, 2480000, 2472791, 2465581,
	2458372, 2451163, 2443953, 2436744, 2429535, 2422326, 2415116, 2407907, 2400698, 2393488,
	2386279, 2379070, 2371860, 2364651, 2357442, 2350233, 2343023, 2335814, 2328605, 2321395,
	2314186, 2306977, 2299767, 2292558, 2285349, 2278140, 2270930, 2263721, 2256512, 2249302,
	2242093, 2234884, 2227674, 2220465, 2213256, 2206047, 2198837, 2191628, 2184419, 2177209,
	2170000, 2162791, 2155581, 2148372, 2141163, 2133953, 2126744, 2119535, 2112326, 2105116,
	2097907, 2090698, 2083488, 2076279, 2069070, 2061860, 2054651, 2047442, 2040233, 2033023,
	2025814, 2018605, 2011395, 2004186, 1996977, 1989767, 1982558, 1975349, 1968140, 1960930,
	1953721, 1946512, 1939302, 1932093, 1924884, 1917674, 1910465, 1903256, 1896047, 1888837,
	1881628, 1874419, 1867209, 1860000, 1852791, 1845581, 1838372, 1831163, 1823953, 1816744,
	1809535, 1802326, 1795116, 1787907, 1780698, 1773488, 1766279, 1759070, 1751860, 1744651,
	1737442, 1730233, 1723023, 1715814, 1708605, 1701395, 1694186, 1686977, 1679767, 1672558,
	1665349, 1658140, 1650930, 1643721, 1636512, 1629302, 1622093, 1614884, 1607674, 1600465,
	1593256, 1586047, 1578837, 1571628, 1564419, 1557209, 1550000, 1542791, 1535581, 1528372,
	1521163, 1513953, 1506744, 1499535, 1492326, 1485116, 1477907, 1470698, 1463488, 1456279,
	1449070, 1441860, 1434651, 1427442, 1420233, 1413023, 1405814, 1398605, 1391395, 1384186,
	1376977, 1369767, 1362558, 1355349, 1348140, 1340930, 1333721, 1326512, 1319302, 1312093,
	1304884, 1297674, 1290465, 1283256, 1276047, 1268837, 1261628, 1254419, 1247209, 1240000,
	1232791, 1225581, 1218372, 1211163, 1203953, 1196744, 1189535, 1182326, 1175116, 1167907,
	1160698, 1153488, 1146279, 1139070, 1131860, 1124651, 1117442, 1110233, 1103023, 1095814,
	1088605, 1081395, 1074186, 1066977, 1059767, 1052558, 1045349, 1038140, 1030930, 1023721,
	1016512, 1009302, 1002093, 994884, 987674, 980465, 973256, 966047, 958837, 951628,
	944419, 937209, 930000, 922791, 915581, 908372, 901163, 893953, 886744, 879535,
	872326, 865116, 857907,
};

static const short int_tbl_v1_v7[5] = {
	171, 341, 512, 683, 853,
};


static const short int_tbl_v7_v11[3] = {
	256, 512, 768
};


static const short int_tbl_v11_v23[11] = {
	85, 171, 256, 341, 427, 512, 597, 683,
	768, 853, 939,
};


static const short int_tbl_v23_v35[11] = {
	85, 171, 256, 341, 427, 512, 597, 683,
	768, 853, 939,
};


static const short int_tbl_v35_v51[15] = {
	64, 128, 192, 256, 320, 384, 448, 512,
	576, 640, 704, 768, 832, 896, 960,
};

static const short int_tbl_v51_v87[35] = {
	28,	57,	85,	114, 142, 171, 199, 228,
	256, 284, 313, 341, 370, 398, 427, 455,
	484, 512, 540, 569, 597, 626, 654, 683,
	711, 740, 768, 796, 825, 853, 882, 910,
	939, 967, 996,
};

static const short int_tbl_v87_v151[63] = {
	16,	32, 48, 64, 80, 96, 112, 128,
	144, 160, 176, 192, 208, 224, 240, 256,
	272, 288, 304, 320, 336, 352, 368, 384,
	400, 416, 432, 448, 464, 480, 496, 512,
	528, 544, 560, 576, 592, 608, 624, 640,
	656, 672, 688, 704, 720, 736, 752, 768,
	784, 800, 816, 832, 848, 864, 880, 896,
	912, 928, 944, 960, 976, 992, 1008,
};


static const short int_tbl_v151_v203[51] = {
	20, 39, 59, 79, 98, 118, 138, 158,
	177, 197, 217, 236, 256, 276, 295, 315,
	335, 354, 374, 394, 414, 433, 453, 473,
	492, 512, 532, 551, 571, 591, 610, 630,
	650, 670, 689, 709, 729, 748, 768, 788,
	807, 827, 847, 866, 886, 906, 926, 945,
	965, 985, 1004,
};

static const short int_tbl_v203_v255[51] = {
	20, 39, 59, 79, 98, 118, 138, 158,
	177, 197, 217, 236, 256, 276, 295, 315,
	335, 354, 374, 394, 414, 433, 453, 473,
	492, 512, 532, 551, 571, 591, 610, 630,
	650, 670, 689, 709, 729, 748, 768, 788,
	807, 827, 847, 866, 886, 906, 926, 945,
	965, 985, 1004,
};

static const signed char a3_da_rtbl10nit[10] = {0, 20, 19, 16, 13, 10, 6, 4, 0, 0};
static const signed char a3_da_rtbl11nit[10] = {0, 20, 19, 16, 13, 10, 6, 4, 1, 0};
static const signed char a3_da_rtbl12nit[10] = {0, 19, 18, 15, 12, 9, 5, 3, 0, 0};
static const signed char a3_da_rtbl13nit[10] = {0, 18, 17, 14, 11, 8, 4, 2, -1, 0};
static const signed char a3_da_rtbl14nit[10] = {0, 18, 17, 14, 11, 8, 4, 2, 0, 0};
static const signed char a3_da_rtbl15nit[10] = {0, 17, 16, 13, 10, 8, 4, 2, 0, 0};
static const signed char a3_da_rtbl16nit[10] = {0, 16, 15, 12, 9, 7, 3, 2, 0, 0};
static const signed char a3_da_rtbl17nit[10] = {0, 16, 15, 12, 9, 7, 3, 2, 0, 0};
static const signed char a3_da_rtbl19nit[10] = {0, 15, 14, 11, 8, 6, 3, 2, 0, 0};
static const signed char a3_da_rtbl20nit[10] = {0, 15, 14, 11, 8, 6, 3, 2, 0, 0};
static const signed char a3_da_rtbl21nit[10] = {0, 14, 13, 10, 7, 5, 2, 2, 0, 0};
static const signed char a3_da_rtbl22nit[10] = {0, 14, 13, 10, 7, 5, 2, 2, 0, 0};
static const signed char a3_da_rtbl24nit[10] = {0, 13, 12, 9, 7, 5, 2, 2, 0, 0};
static const signed char a3_da_rtbl25nit[10] = {0, 13, 12, 9, 7, 5, 2, 2, 0, 0};
static const signed char a3_da_rtbl27nit[10] = {0, 12, 11, 8, 6, 4, 2, 2, 0, 0};
static const signed char a3_da_rtbl29nit[10] = {0, 12, 11, 8, 6, 4, 2, 2, 0, 0};
static const signed char a3_da_rtbl30nit[10] = {0, 12, 11, 8, 6, 4, 2, 2, 0, 0};
static const signed char a3_da_rtbl32nit[10] = {0, 12, 11, 8, 6, 4, 2, 2, 0, 0};
static const signed char a3_da_rtbl34nit[10] = {0, 11, 10, 7, 5, 3, 1, 2, 0, 0};
static const signed char a3_da_rtbl37nit[10] = {0, 10, 9, 6, 4, 2, 1, 2, 0, 0};
static const signed char a3_da_rtbl39nit[10] = {0, 9, 8, 5, 3, 2, 1, 2, 0, 0};
static const signed char a3_da_rtbl41nit[10] = {0, 8, 7, 5, 3, 2, 1, 2, 0, 0};
static const signed char a3_da_rtbl44nit[10] = {0, 7, 6, 4, 3, 2, 1, 2, 0, 0};
static const signed char a3_da_rtbl47nit[10] = {0, 6, 5, 3, 2, 1, 1, 2, 0, 0};
static const signed char a3_da_rtbl50nit[10] = {0, 6, 5, 3, 2, 1, 1, 2, 0, 0};
static const signed char a3_da_rtbl53nit[10] = {0, 6, 5, 3, 2, 1, 1, 2, 0, 0};
static const signed char a3_da_rtbl56nit[10] = {0, 6, 5, 3, 2, 1, 1, 2, 0, 0};
static const signed char a3_da_rtbl60nit[10] = {0, 5, 4, 3, 2, 1, 1, 2, 0, 0};
static const signed char a3_da_rtbl64nit[10] = {0, 5, 4, 3, 2, 1, 1, 1, 0, 0};
static const signed char a3_da_rtbl68nit[10] = {0, 5, 4, 2, 2, 1, 1, 1, 0, 0};
static const signed char a3_da_rtbl72nit[10] = {0, 6, 5, 3, 2, 2, 1, 1, 0, 0};
static const signed char a3_da_rtbl77nit[10] = {0, 6, 5, 3, 3, 2, 1, 1, 0, 0};
static const signed char a3_da_rtbl82nit[10] = {0, 5, 4, 3, 3, 2, 1, 0, 1, 0};
static const signed char a3_da_rtbl87nit[10] = {0, 5, 4, 3, 3, 2, 1, 0, 1, 0};
static const signed char a3_da_rtbl93nit[10] = {0, 5, 4, 3, 3, 2, 1, 0, 1, 0};
static const signed char a3_da_rtbl98nit[10] = {0, 5, 4, 3, 2, 2, 1, 0, 1, 0};
static const signed char a3_da_rtbl105nit[10] = {0, 6, 5, 3, 3, 2, 1, 0, 1, 0};
static const signed char a3_da_rtbl111nit[10] = {0, 6, 5, 3, 2, 1, 0, 0, 1, 0};
static const signed char a3_da_rtbl119nit[10] = {0, 5, 4, 3, 2, 1, 0, 0, 1, 0};
static const signed char a3_da_rtbl126nit[10] = {0, 5, 3, 2, 1, 1, 0, 0, 1, 0};
static const signed char a3_da_rtbl134nit[10] = {0, 5, 3, 2, 1, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl143nit[10] = {0, 5, 3, 2, 1, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl152nit[10] = {0, 4, 3, 2, 1, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl162nit[10] = {0, 4, 3, 2, 1, -1, 0, 0, 0, 0};
static const signed char a3_da_rtbl172nit[10] = {0, 4, 3, 1, 0, -1, 0, 0, 0, 0};
static const signed char a3_da_rtbl183nit[10] = {0, 4, 3, 1, 0, -1, 0, 0, 0, 0};
static const signed char a3_da_rtbl195nit[10] = {0, 3, 2, 1, 0, -1, 0, 0, 0, 0};
static const signed char a3_da_rtbl207nit[10] = {0, 2, 1, 0, 0, -1, 0, 0, 0, 0};
static const signed char a3_da_rtbl220nit[10] = {0, 2, 1, 0, 0, -1, 0, 0, 0, 0};
static const signed char a3_da_rtbl234nit[10] = {0, 2, 0, 1, 1, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl249nit[10] = {0, 2, 0, 1, 1, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl265nit[10] = {0, 2, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl282nit[10] = {0, 2, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl300nit[10] = {0, 2, 1, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl316nit[10] = {0, 2, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl333nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl350nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl357nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl365nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl372nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl380nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl387nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl395nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl403nit[10] = {0, 1, 0, 1, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl412nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl420nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl443nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl465nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl488nit[10] = {0, 1, 0, 0, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_rtbl510nit[10] = {0, 0, 0, 0, 0, 0, 0, 1, 1, 0};
static const signed char a3_da_rtbl533nit[10] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 0};
static const signed char a3_da_rtbl555nit[10] = {0, 0, 0, 0, 0, 0, 1, 0, 0, 0};
static const signed char a3_da_rtbl578nit[10] = {0, 0, 0, 0, 0, 0, 0, 1, 0, 0};
static const signed char a3_da_rtbl600nit[10] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

static const signed char a3_da_ctbl10nit[30] = {0, 0, 0, 2, 3, 1, -8, 3, -7, -7, 3, -11, -8, 3, -12, -10, 2, -11, -10, 1, -9, -2, 0, -2, -3, -1, -2, -3, 0, -1};
static const signed char a3_da_ctbl11nit[30] = {0, 0, 0, 2, 3, 1, -8, 2, -6, -9, 2, -12, -9, 0, -14, -14, 1, -13, -6, 1, -6, -3, 1, -1, -1, 0, -1, -3, 0, -1};
static const signed char a3_da_ctbl12nit[30] = {0, 0, 0, 2, 3, 1, -9, 2, -9, -10, 1, -13, -9, 0, -12, -14, 0, -14, -7, 1, -5, -1, 2, 0, -2, 0, -1, -2, 0, -1};
static const signed char a3_da_ctbl13nit[30] = {0, 0, 0, 2, 3, 1, -7, 3, -7, -11, 0, -13, -10, 0, -15, -12, 0, -11, -6, 1, -5, 0, 3, 1, 0, 1, 0, -2, 0, -1};
static const signed char a3_da_ctbl14nit[30] = {0, 0, 0, 2, 3, 1, -7, 3, -7, -13, -1, -14, -13, -2, -16, -13, 0, -12, -6, 0, -5, 0, 3, 0, -1, 0, 0, -2, 0, -1};
static const signed char a3_da_ctbl15nit[30] = {0, 0, 0, 2, 3, 1, -6, 3, -6, -14, -1, -16, -9, 2, -12, -13, -1, -12, -7, -1, -7, 0, 2, 0, -1, 0, 0, -2, 0, -1};
static const signed char a3_da_ctbl16nit[30] = {0, 0, 0, 2, 3, 1, -7, 2, -7, -12, 0, -14, -9, 3, -12, -13, -2, -13, -6, 0, -4, 1, 3, 1, -2, -1, -1, -2, 0, -1};
static const signed char a3_da_ctbl17nit[30] = {0, 0, 0, 2, 3, 1, -9, 3, -8, -15, -2, -18, -9, 3, -9, -13, -3, -13, -5, 1, -3, 0, 3, 1, -2, -1, -2, -1, 0, 0};
static const signed char a3_da_ctbl19nit[30] = {0, 0, 0, 2, 3, 1, -10, 2, -12, -16, -2, -17, -9, 0, -10, -11, 1, -9, -6, 0, -4, 0, 2, 0, -2, -1, -2, -1, 0, 0};
static const signed char a3_da_ctbl20nit[30] = {0, 0, 0, 2, 3, 1, -10, 2, -10, -19, -4, -20, -10, 0, -10, -11, 0, -10, -6, -1, -4, 0, 2, 0, -2, -1, -2, -1, 0, 0};
static const signed char a3_da_ctbl21nit[30] = {0, 0, 0, 2, 3, 1, -11, 0, -11, -15, -2, -16, -10, 1, -11, -10, 0, -10, -2, 3, -1, -1, 1, -1, -2, -1, -1, -1, 0, 0};
static const signed char a3_da_ctbl22nit[30] = {0, 0, 0, 2, 3, 1, -11, 1, -11, -18, -4, -18, -10, 0, -11, -11, -1, -11, -2, 3, -1, -1, 1, -1, -2, -1, -1, -1, 0, 0};
static const signed char a3_da_ctbl24nit[30] = {0, 0, 0, 2, 3, 1, -14, -1, -14, -9, 3, -12, -12, -1, -12, -12, -2, -11, -3, 2, -1, -2, 0, -2, -1, -1, -1, -1, 0, 0};
static const signed char a3_da_ctbl25nit[30] = {0, 0, 0, 2, 3, 1, -13, 0, -13, -13, 1, -15, -13, -2, -12, -11, -2, -11, -3, 2, -1, -1, 1, -1, -1, -1, -1, -1, 0, 0};
static const signed char a3_da_ctbl27nit[30] = {0, 0, 0, 2, 3, 1, -15, -1, -15, -12, 2, -12, -12, -2, -11, -8, 1, -8, -4, 1, -3, 0, 1, 0, -1, -1, -1, -1, 0, 0};
static const signed char a3_da_ctbl29nit[30] = {0, 0, 0, 2, 3, 1, -15, -1, -15, -12, 1, -13, -12, -3, -12, -8, 0, -8, -4, 1, -2, 0, 1, 0, -1, -1, -1, -1, 0, 0};
static const signed char a3_da_ctbl30nit[30] = {0, 0, 0, 2, 3, 1, -17, -2, -17, -13, 1, -13, -13, -4, -12, -10, -2, -9, -3, 1, -2, 1, 2, 1, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl32nit[30] = {0, 0, 0, 2, 3, 1, -17, -3, -17, -15, -1, -15, -14, -5, -13, -9, -2, -8, -4, 0, -3, 0, 1, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl34nit[30] = {0, 0, 0, 2, 3, 1, -18, -3, -17, -17, -3, -16, -12, -4, -12, -6, 0, -5, -2, 2, 0, 0, 1, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl37nit[30] = {0, 0, 0, 1, 3, 0, -19, -3, -17, -17, -4, -17, -8, -1, -8, -6, 1, -5, -1, 2, 0, 0, 1, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl39nit[30] = {0, 0, 0, 1, 3, 0, -19, -4, -18, -17, -3, -16, -5, 2, -6, -3, 1, -2, -1, 2, 0, 0, 1, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl41nit[30] = {0, 0, 0, 2, 2, 1, -11, 4, -11, -17, -4, -17, -5, 2, -5, -4, 1, -3, -1, 2, 0, 0, 0, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl44nit[30] = {0, 0, 0, 2, 2, 2, -11, 5, -12, -12, 1, -12, -5, 1, -5, -4, 0, -3, -1, 2, 0, 0, 0, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl47nit[30] = {0, 0, 0, 3, 3, 2, -10, 2, -11, -12, 1, -12, -2, 3, -2, -1, 4, 0, -1, 1, 0, 0, 0, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl50nit[30] = {0, 0, 0, 3, 3, 3, -15, 0, -15, -12, 0, -11, -5, 1, -4, 0, 3, 0, -1, 1, 0, 0, 0, 0, -2, -2, -2, -1, 0, 0};
static const signed char a3_da_ctbl53nit[30] = {0, 0, 0, 4, 3, 3, -15, 0, -14, -14, -2, -14, -4, 1, -2, 0, 3, 0, -2, 0, -1, -1, 0, -1, -2, -2, -1, 0, 0, 0};
static const signed char a3_da_ctbl56nit[30] = {0, 0, 0, 4, 3, 3, -19, -2, -17, -13, -2, -13, -5, -1, -3, 0, 3, 0, -2, 0, -1, -1, 0, -1, -2, -2, -1, 0, 0, 0};
static const signed char a3_da_ctbl60nit[30] = {0, 0, 0, 0, 1, -1, -15, -2, -14, -6, 2, -5, -5, -1, -4, -1, 2, -1, -1, 0, 0, -1, 0, -1, -2, -2, -1, 0, 0, 0};
static const signed char a3_da_ctbl64nit[30] = {0, 0, 0, 1, 2, 0, -16, -2, -14, -7, 1, -7, -4, -1, -3, -2, 1, -1, -3, -1, -2, 0, 0, 0, -2, -2, -1, 0, 0, 0};
static const signed char a3_da_ctbl68nit[30] = {0, 0, 0, 0, 2, 0, -18, -4, -17, -7, 0, -7, -1, 2, 0, -2, 0, -2, -2, 0, 0, 0, 0, 1, -2, -2, -2, 0, 0, 1};
static const signed char a3_da_ctbl72nit[30] = {0, 0, 0, -2, 1, -2, -20, -3, -18, -8, -1, -7, -4, -1, -5, -5, -3, -4, -2, 0, -1, 0, 0, 0, -1, -1, 0, -1, 0, 0};
static const signed char a3_da_ctbl77nit[30] = {0, 0, 0, -2, 1, -2, -20, -3, -18, -5, 3, -4, -6, -3, -5, -5, -3, -4, -1, 0, -1, -1, 0, 0, -1, -1, -1, 0, 0, 1};
static const signed char a3_da_ctbl82nit[30] = {0, 0, 0, -1, 1, -2, -12, 3, -11, -5, 2, -5, -5, -3, -4, -4, -1, -3, -1, 0, -1, 0, 1, 1, -1, -1, -1, 0, 0, 1};
static const signed char a3_da_ctbl87nit[30] = {0, 0, 0, -3, 1, -2, -16, 2, -14, -6, -1, -6, -5, -3, -4, -3, -1, -3, -3, -3, -2, 0, 1, 0, -1, -1, 0, -1, 0, 1};
static const signed char a3_da_ctbl93nit[30] = {0, 0, 0, -3, 0, -3, -18, -1, -17, -4, 1, -4, -4, -1, -3, -4, -2, -3, -3, -2, -2, 0, 1, 0, -1, -1, -1, 0, 0, 1};
static const signed char a3_da_ctbl98nit[30] = {0, 0, 0, -3, 0, -3, -18, -1, -16, -6, 1, -5, -3, -2, -3, -3, -1, -2, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 1};
static const signed char a3_da_ctbl105nit[30] = {0, 0, 0, -4, 0, -3, -21, -2, -19, -8, -3, -7, -6, -3, -5, -3, -1, -2, -1, 0, -1, -1, -1, -1, 0, 0, 1, -1, 0, 0};
static const signed char a3_da_ctbl111nit[30] = {0, 0, 0, -6, -1, -5, -21, -2, -19, -10, -4, -8, -6, -3, -5, -1, 0, -1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0};
static const signed char a3_da_ctbl119nit[30] = {0, 0, 0, -6, -1, -5, -13, 2, -12, -10, -5, -8, -2, 0, -2, -1, 1, -1, 0, 1, 1, -1, -1, -2, 1, 1, 1, 0, 0, 0};
static const signed char a3_da_ctbl126nit[30] = {0, 0, 0, -6, -1, -5, -17, -1, -16, -10, -5, -8, -1, 1, 0, 1, 2, 0, 0, 1, 0, 0, -1, 0, 0, 1, 1, 0, 0, 0};
static const signed char a3_da_ctbl134nit[30] = {0, 0, 0, -8, -2, -7, -17, -2, -16, -8, -4, -6, 0, 1, -1, 1, 3, 1, 0, 1, 1, 0, 0, 0, 2, 2, 2, 0, 0, 0};
static const signed char a3_da_ctbl143nit[30] = {0, 0, 0, -8, -2, -7, -17, -2, -16, -3, -1, -2, -2, 0, -2, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 2, 2, 0, 0, 0};
static const signed char a3_da_ctbl152nit[30] = {0, 0, 0, -7, -2, -7, -14, 1, -13, -5, -2, -3, -4, -2, -3, 0, 0, -1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0};
static const signed char a3_da_ctbl162nit[30] = {0, 0, 0, -9, -3, -9, -14, 0, -13, -4, -2, -3, -2, 0, -1, 0, 2, 0, 1, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0};
static const signed char a3_da_ctbl172nit[30] = {0, 0, 0, -9, -3, -9, -16, -2, -15, -4, -3, -3, 0, 3, -1, 0, 1, 0, 2, 2, 2, 2, 2, 1, 0, 1, 0, 0, 0, 1};
static const signed char a3_da_ctbl183nit[30] = {0, 0, 0, -11, -4, -10, -16, -3, -15, -4, -3, -3, 1, 3, 0, 0, 1, 0, 2, 2, 2, 1, 1, 0, 0, 1, 0, 0, 0, 0};
static const signed char a3_da_ctbl195nit[30] = {0, 0, 0, -10, -4, -10, -11, 1, -10, -3, -3, -3, 0, 1, -1, 0, 1, 1, 2, 2, 2, 1, 1, 0, 0, 1, 0, 0, 0, 0};
static const signed char a3_da_ctbl207nit[30] = {0, 0, 0, -10, -4, -10, -9, 0, -8, 2, 2, 2, -2, 0, -2, 1, 1, 0, 1, 2, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0};
static const signed char a3_da_ctbl220nit[30] = {0, 0, 0, -11, -5, -12, -8, -1, -7, 2, 2, 2, -1, 0, -1, 0, 0, -1, 2, 2, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1};
static const signed char a3_da_ctbl234nit[30] = {0, 0, 0, -11, -5, -11, -6, 1, -6, 1, 0, 1, -3, -2, -2, -1, -1, -1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1};
static const signed char a3_da_ctbl249nit[30] = {0, 0, 0, -11, -5, -11, -6, 0, -6, 3, 2, 2, -3, -3, -3, 0, -1, 0, 0, 1, 1, 2, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl265nit[30] = {0, 0, 0, -13, -6, -12, -7, -1, -6, 3, 2, 2, 0, 0, 0, -1, -1, 0, -2, 0, -1, 2, 2, 2, 0, 0, 0, 1, 0, 0};
static const signed char a3_da_ctbl282nit[30] = {0, 0, 0, -12, -6, -12, -7, -1, -6, 4, 3, 3, 1, 1, 1, -3, -2, -2, 1, 1, 1, 2, 2, 2, 0, 0, 0, 1, 0, 1};
static const signed char a3_da_ctbl300nit[30] = {0, 0, 0, -11, -4, -10, -9, -3, -7, 0, 0, 0, 1, 1, 0, -1, -1, 0, 1, 1, 1, 2, 2, 2, -1, 0, 0, 1, 0, 0};
static const signed char a3_da_ctbl316nit[30] = {0, 0, 0, -11, -4, -9, -6, -3, -5, 4, 3, 4, 0, 0, 0, -1, 0, -1, 1, 1, 2, 1, 2, 1, -1, 0, 0, 1, 0, 0};
static const signed char a3_da_ctbl333nit[30] = {0, 0, 0, -9, -3, -9, -7, -1, -5, 0, -1, 0, 2, 2, 1, -1, 0, 0, 0, 0, 0, 1, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl350nit[30] = {0, 0, 0, -10, -4, -8, -7, -2, -5, 2, 1, 1, 0, 0, 0, -1, 0, 0, 1, 0, 0, 1, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl357nit[30] = {0, 0, 0, -11, -5, -10, -7, -3, -5, 2, 2, 2, 1, 0, 0, -1, 0, 0, 2, 1, 1, 1, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl365nit[30] = {0, 0, 0, -11, -5, -10, -6, -3, -4, 3, 2, 2, 1, 0, 0, -1, 0, 0, 2, 1, 1, 1, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl372nit[30] = {0, 0, 0, -10, -5, -10, -5, -3, -5, 3, 2, 2, 1, 0, 0, -1, 0, 0, 1, 1, 0, 1, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl380nit[30] = {0, 0, 0, -10, -5, -10, -5, -3, -5, 3, 2, 2, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 1, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl387nit[30] = {0, 0, 0, -10, -5, -10, -5, -3, -5, 2, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl395nit[30] = {0, 0, 0, -10, -5, -9, -5, -3, -4, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl403nit[30] = {0, 0, 0, -10, -5, -9, -2, 0, -2, -3, -4, -2, 3, 2, 2, 0, 0, 0, 0, 0, 0, 1, 2, 1, -1, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl412nit[30] = {0, 0, 0, -10, -5, -9, -2, -1, -2, 0, -1, 1, 0, -2, -2, 0, 0, 0, 0, 0, 0, 1, 2, 1, 0, 0, 1, 0, 0, 0};
static const signed char a3_da_ctbl420nit[30] = {0, 0, 0, -9, -5, -9, -2, -1, -2, 0, -1, 0, 1, 0, 1, -1, -1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl443nit[30] = {0, 0, 0, -5, -3, -5, -6, -4, -6, 2, 2, 2, -1, -1, -1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl465nit[30] = {0, 0, 0, -4, -2, -4, -4, -3, -4, -1, -3, -2, 2, 1, 1, -2, 0, -1, 1, 0, 1, 1, 1, 1, 1, 0, 1, -1, 0, 0};
static const signed char a3_da_ctbl488nit[30] = {0, 0, 0, -6, -4, -6, -4, -3, -4, 4, 3, 3, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, -1, 0, 0};
static const signed char a3_da_ctbl510nit[30] = {0, 0, 0, -4, -2, -5, 2, 3, 3, -1, -1, -1, -2, -2, -1, 0, -1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, -1, 0, 0};
static const signed char a3_da_ctbl533nit[30] = {0, 0, 0, -5, -3, -5, 2, 2, 3, -1, -1, -1, 0, 0, 0, -1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0};
static const signed char a3_da_ctbl555nit[30] = {0, 0, 0, 2, 1, 1, -3, -2, -2, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 1, 0, 0, -1, 0, 0};
static const signed char a3_da_ctbl578nit[30] = {0, 0, 0, 0, 1, 0, 0, 0, 0, -2, -2, -2, 0, 0, 0, -1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0};
static const signed char a3_da_ctbl600nit[30] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};


const struct SmtDimInfo s6e36w4x01_dimming_info[MAX_BR_INFO] = {
	{ .br = 10, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl10nit, .cTbl = a3_da_ctbl10nit, .way = W1},
	{ .br = 11, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl11nit, .cTbl = a3_da_ctbl11nit, .way = W1},
	{ .br = 12, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl12nit, .cTbl = a3_da_ctbl12nit, .way = W1},
	{ .br = 13, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl13nit, .cTbl = a3_da_ctbl13nit, .way = W1},
	{ .br = 14, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl14nit, .cTbl = a3_da_ctbl14nit, .way = W1},
	{ .br = 15, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl15nit, .cTbl = a3_da_ctbl15nit, .way = W1},
	{ .br = 16, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl16nit, .cTbl = a3_da_ctbl16nit, .way = W1},
	{ .br = 17, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl17nit, .cTbl = a3_da_ctbl17nit, .way = W1},
	{ .br = 19, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl19nit, .cTbl = a3_da_ctbl19nit, .way = W1},
	{ .br = 20, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl20nit, .cTbl = a3_da_ctbl20nit, .way = W1},
	{ .br = 21, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl21nit, .cTbl = a3_da_ctbl21nit, .way = W1},
	{ .br = 22, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl22nit, .cTbl = a3_da_ctbl22nit, .way = W1},
	{ .br = 24, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl24nit, .cTbl = a3_da_ctbl24nit, .way = W1},
	{ .br = 25, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl25nit, .cTbl = a3_da_ctbl25nit, .way = W1},
	{ .br = 27, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl27nit, .cTbl = a3_da_ctbl27nit, .way = W1},
	{ .br = 29, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl29nit, .cTbl = a3_da_ctbl29nit, .way = W1},
	{ .br = 30, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl30nit, .cTbl = a3_da_ctbl30nit, .way = W1},
	{ .br = 32, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl32nit, .cTbl = a3_da_ctbl32nit, .way = W1},
	{ .br = 34, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl34nit, .cTbl = a3_da_ctbl34nit, .way = W1},
	{ .br = 37, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl37nit, .cTbl = a3_da_ctbl37nit, .way = W1},
	{ .br = 39, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl39nit, .cTbl = a3_da_ctbl39nit, .way = W1},
	{ .br = 41, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl41nit, .cTbl = a3_da_ctbl41nit, .way = W1},
	{ .br = 44, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl44nit, .cTbl = a3_da_ctbl44nit, .way = W1},
	{ .br = 47, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl47nit, .cTbl = a3_da_ctbl47nit, .way = W1},
	{ .br = 50, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl50nit, .cTbl = a3_da_ctbl50nit, .way = W1},
	{ .br = 53, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl53nit, .cTbl = a3_da_ctbl53nit, .way = W1},
	{ .br = 56, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl56nit, .cTbl = a3_da_ctbl56nit, .way = W1},
	{ .br = 60, .refBr = 106, .cGma = gma2p15, .rTbl = a3_da_rtbl60nit, .cTbl = a3_da_ctbl60nit, .way = W1},
	{ .br = 64, .refBr = 107, .cGma = gma2p15, .rTbl = a3_da_rtbl64nit, .cTbl = a3_da_ctbl64nit, .way = W1},
	{ .br = 68, .refBr = 114, .cGma = gma2p15, .rTbl = a3_da_rtbl68nit, .cTbl = a3_da_ctbl68nit, .way = W1},
	{ .br = 72, .refBr = 120, .cGma = gma2p15, .rTbl = a3_da_rtbl72nit, .cTbl = a3_da_ctbl72nit, .way = W1},
	{ .br = 77, .refBr = 127, .cGma = gma2p15, .rTbl = a3_da_rtbl77nit, .cTbl = a3_da_ctbl77nit, .way = W1},
	{ .br = 82, .refBr = 135, .cGma = gma2p15, .rTbl = a3_da_rtbl82nit, .cTbl = a3_da_ctbl82nit, .way = W1},
	{ .br = 87, .refBr = 143, .cGma = gma2p15, .rTbl = a3_da_rtbl87nit, .cTbl = a3_da_ctbl87nit, .way = W1},
	{ .br = 93, .refBr = 150, .cGma = gma2p15, .rTbl = a3_da_rtbl93nit, .cTbl = a3_da_ctbl93nit, .way = W1},
	{ .br = 98, .refBr = 158, .cGma = gma2p15, .rTbl = a3_da_rtbl98nit, .cTbl = a3_da_ctbl98nit, .way = W1},
	{ .br = 105, .refBr = 169, .cGma = gma2p15, .rTbl = a3_da_rtbl105nit, .cTbl = a3_da_ctbl105nit, .way = W1},
	{ .br = 111, .refBr = 177, .cGma = gma2p15, .rTbl = a3_da_rtbl111nit, .cTbl = a3_da_ctbl111nit, .way = W1},
	{ .br = 119, .refBr = 187, .cGma = gma2p15, .rTbl = a3_da_rtbl119nit, .cTbl = a3_da_ctbl119nit, .way = W1},
	{ .br = 126, .refBr = 197, .cGma = gma2p15, .rTbl = a3_da_rtbl126nit, .cTbl = a3_da_ctbl126nit, .way = W1},
	{ .br = 134, .refBr = 208, .cGma = gma2p15, .rTbl = a3_da_rtbl134nit, .cTbl = a3_da_ctbl134nit, .way = W1},
	{ .br = 143, .refBr = 222, .cGma = gma2p15, .rTbl = a3_da_rtbl143nit, .cTbl = a3_da_ctbl143nit, .way = W1},
	{ .br = 152, .refBr = 237, .cGma = gma2p15, .rTbl = a3_da_rtbl152nit, .cTbl = a3_da_ctbl152nit, .way = W1},
	{ .br = 162, .refBr = 253, .cGma = gma2p15, .rTbl = a3_da_rtbl162nit, .cTbl = a3_da_ctbl162nit, .way = W1},
	{ .br = 172, .refBr = 264, .cGma = gma2p15, .rTbl = a3_da_rtbl172nit, .cTbl = a3_da_ctbl172nit, .way = W1},
	{ .br = 183, .refBr = 264, .cGma = gma2p15, .rTbl = a3_da_rtbl183nit, .cTbl = a3_da_ctbl183nit, .way = W1},
	{ .br = 195, .refBr = 264, .cGma = gma2p15, .rTbl = a3_da_rtbl195nit, .cTbl = a3_da_ctbl195nit, .way = W1},
	{ .br = 207, .refBr = 264, .cGma = gma2p15, .rTbl = a3_da_rtbl207nit, .cTbl = a3_da_ctbl207nit, .way = W1},
	{ .br = 220, .refBr = 264, .cGma = gma2p15, .rTbl = a3_da_rtbl220nit, .cTbl = a3_da_ctbl220nit, .way = W1},
	{ .br = 234, .refBr = 269, .cGma = gma2p15, .rTbl = a3_da_rtbl234nit, .cTbl = a3_da_ctbl234nit, .way = W1},
	{ .br = 249, .refBr = 286, .cGma = gma2p15, .rTbl = a3_da_rtbl249nit, .cTbl = a3_da_ctbl249nit, .way = W1},
	{ .br = 265, .refBr = 305, .cGma = gma2p15, .rTbl = a3_da_rtbl265nit, .cTbl = a3_da_ctbl265nit, .way = W1},
	{ .br = 282, .refBr = 323, .cGma = gma2p15, .rTbl = a3_da_rtbl282nit, .cTbl = a3_da_ctbl282nit, .way = W1},
	{ .br = 300, .refBr = 339, .cGma = gma2p15, .rTbl = a3_da_rtbl300nit, .cTbl = a3_da_ctbl300nit, .way = W1},
	{ .br = 316, .refBr = 358, .cGma = gma2p15, .rTbl = a3_da_rtbl316nit, .cTbl = a3_da_ctbl316nit, .way = W1},
	{ .br = 333, .refBr = 380, .cGma = gma2p15, .rTbl = a3_da_rtbl333nit, .cTbl = a3_da_ctbl333nit, .way = W1},
	{ .br = 350, .refBr = 398, .cGma = gma2p15, .rTbl = a3_da_rtbl350nit, .cTbl = a3_da_ctbl350nit, .way = W1},
	{ .br = 357, .refBr = 402, .cGma = gma2p15, .rTbl = a3_da_rtbl357nit, .cTbl = a3_da_ctbl357nit, .way = W1},
	{ .br = 365, .refBr = 402, .cGma = gma2p15, .rTbl = a3_da_rtbl365nit, .cTbl = a3_da_ctbl365nit, .way = W1},
	{ .br = 372, .refBr = 402, .cGma = gma2p15, .rTbl = a3_da_rtbl372nit, .cTbl = a3_da_ctbl372nit, .way = W1},
	{ .br = 380, .refBr = 402, .cGma = gma2p15, .rTbl = a3_da_rtbl380nit, .cTbl = a3_da_ctbl380nit, .way = W1},
	{ .br = 387, .refBr = 402, .cGma = gma2p15, .rTbl = a3_da_rtbl387nit, .cTbl = a3_da_ctbl387nit, .way = W1},
	{ .br = 395, .refBr = 407, .cGma = gma2p15, .rTbl = a3_da_rtbl395nit, .cTbl = a3_da_ctbl395nit, .way = W1},
	{ .br = 403, .refBr = 415, .cGma = gma2p15, .rTbl = a3_da_rtbl403nit, .cTbl = a3_da_ctbl403nit, .way = W1},
	{ .br = 412, .refBr = 425, .cGma = gma2p15, .rTbl = a3_da_rtbl412nit, .cTbl = a3_da_ctbl412nit, .way = W1},
	{ .br = 420, .refBr = 432, .cGma = gma2p15, .rTbl = a3_da_rtbl420nit, .cTbl = a3_da_ctbl420nit, .way = W1},
	{ .br = 443, .refBr = 452, .cGma = gma2p15, .rTbl = a3_da_rtbl443nit, .cTbl = a3_da_ctbl443nit, .way = W1},
	{ .br = 465, .refBr = 475, .cGma = gma2p15, .rTbl = a3_da_rtbl465nit, .cTbl = a3_da_ctbl465nit, .way = W1},
	{ .br = 488, .refBr = 498, .cGma = gma2p15, .rTbl = a3_da_rtbl488nit, .cTbl = a3_da_ctbl488nit, .way = W1},
	{ .br = 510, .refBr = 520, .cGma = gma2p15, .rTbl = a3_da_rtbl510nit, .cTbl = a3_da_ctbl510nit, .way = W1},
	{ .br = 533, .refBr = 539, .cGma = gma2p15, .rTbl = a3_da_rtbl533nit, .cTbl = a3_da_ctbl533nit, .way = W1},
	{ .br = 555, .refBr = 563, .cGma = gma2p15, .rTbl = a3_da_rtbl555nit, .cTbl = a3_da_ctbl555nit, .way = W1},
	{ .br = 578, .refBr = 583, .cGma = gma2p15, .rTbl = a3_da_rtbl578nit, .cTbl = a3_da_ctbl578nit, .way = W1},
	{ .br = 600, .refBr = 600, .cGma = gma2p20, .rTbl = a3_da_rtbl600nit, .cTbl = a3_da_ctbl600nit, .way = W1},

};

static const unsigned char mtp_default[S6E36W4_MTP_SIZE] = {
	0, 46, 46, 83, 89, 90, 91, 86, 85, 88,
	64, 62, 67, 72, 70, 76, 90, 90, 94, 84,
	89, 92, 59, 72, 69, 106, 116, 107, 42, 42,
	 58, 0, 2, 50,
};

void s6e36w4x01_read_gamma(struct smart_dimming *dimming, const unsigned char *data)
{
	int i, j;
	int temp, tmp;
	u8 pos = 0;
	u8 s_v255[3]={0,};

	tmp = (data[31] & 0xf0) >> 4;
	s_v255[0] = (tmp >> 3) & 0x1;
	s_v255[1] = (tmp >> 2) & 0x1;
	s_v255[2] = (tmp >> 1) & 0x1;

	for (j = 0; j < CI_MAX; j++) {
		temp = ((s_v255[j] & 0x01) ? -1 : 1) * data[pos];
		dimming->gamma[V255][j] = ref_gamma[V255][j] + temp;
		dimming->mtp[V255][j] = temp;
		pos ++;
	}

	for (i = V203; i >= V1; i--) {
		for (j = 0; j < CI_MAX; j++) {
			temp = ((data[pos] & 0x80) ? -1 : 1) *
					(data[pos] & 0x7f);
			dimming->gamma[i][j] = ref_gamma[i][j] + temp;
			dimming->mtp[i][j] = temp;
			pos++;
		}
	}

	temp =data[pos] & 0xf;
	dimming->gamma[V1][CI_RED] = ref_gamma[V1][CI_RED] + temp;
	dimming->mtp[V1][CI_RED] = temp;

	temp = (data[pos] & 0xf0) >> 4;
	dimming->gamma[V1][CI_GREEN] = ref_gamma[V1][CI_GREEN] + temp;
	dimming->mtp[V1][CI_GREEN] = temp;

	temp =data[++pos] & 0xf;
	dimming->gamma[V1][CI_BLUE] = ref_gamma[V1][CI_BLUE] + temp;
	dimming->mtp[V1][CI_BLUE] = temp;

	pr_info("%s:MTP OFFSET\n", __func__);
	for (i = V1; i<= V255; i++)
		pr_info("%d %d %d\n", dimming->mtp[i][0],
				dimming->mtp[i][1],dimming->mtp[i][2]);

	pr_debug("MTP+ Center gamma\n");
	for (i = V1; i<= V255; i++)
		pr_debug("%d %d %d\n", dimming->gamma[i][0],
			dimming->gamma[i][1], dimming->gamma[i][2]);
}

static int calc_vt_volt(int gamma)
{
	int max;

	max = (sizeof(vt_trans_volt) >> 2) - 1;
	if (gamma > max) {
		pr_err(" %s exceed gamma value\n", __func__);
		gamma = max;
	}

	return (int)vt_trans_volt[gamma];
}

static int calc_v0_volt(int gamma)
{
	int max;

	max = (sizeof(v0_trans_volt) >> 2) - 1;
	if (gamma > max) {
		pr_err(" %s exceed gamma value\n", __func__);
		gamma = max;
	}

	return (int)v0_trans_volt[gamma];
}

static int calc_v1_volt(struct dim_data *data, int color)
{
	int gap;
	int ret, v7, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V1][color];

	if (gamma > vreg_element_max[V1]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V1];
	}
	if (gamma < 0) {
		pr_err(":%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	v7 = data->volt[TBL_INDEX_V7][color];
	gap = (DOUBLE_MULTIPLE_VREGOUT - v7);
	temp = (unsigned long)gap * (unsigned long)v1_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;

	ret = DOUBLE_MULTIPLE_VREGOUT - (int)temp;
	//printk("[LCD] calc_v1_volt : ret : %d, gamma : %d\n", ret, gamma);

	return ret;
}

static int calc_v7_volt(struct dim_data *data, int color)
{
	int gap;
	int ret, v11, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V7][color];

	if (gamma > vreg_element_max[V7]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V7];
	}
	if (gamma < 0) {
		pr_err(":%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	v11 = data->volt[TBL_INDEX_V11][color];

	gap = (DOUBLE_MULTIPLE_VREGOUT - v11);
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;

	ret = DOUBLE_MULTIPLE_VREGOUT - (int)temp;
	//printk("[LCD] calc_v7_volt : ret : %d\n", ret);

	return ret;
}

static int calc_v11_volt(struct dim_data *data, int color)
{
	int gap;
	int vt, ret, v23, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V11][color];

	if (gamma > vreg_element_max[V11]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V11];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	vt = data->volt_vt[color];
	v23 = data->volt[TBL_INDEX_V23][color];

	gap = vt - v23;
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;

	ret = vt - (int)temp;
	//printk("[LCD] calc_v11_volt : ret : %d\n", ret);

	return ret ;
}

static int calc_v23_volt(struct dim_data *data, int color)
{
	int gap;
	int vt, ret, v35, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V23][color];

	if (gamma > vreg_element_max[V23]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V23];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}


	vt = data->volt_vt[color];
	v35 = data->volt[TBL_INDEX_V35][color];

	gap = vt - v35;
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;

	ret = vt - (int)temp;
	//printk("[LCD] calc_v23_volt : ret : %d\n", ret);

	return ret;

}

static int calc_v35_volt(struct dim_data *data, int color)
{
	int gap;
	int vt, ret, v51, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V35][color];

	if (gamma > vreg_element_max[V35]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V35];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	vt = data->volt_vt[color];
	v51 = data->volt[TBL_INDEX_V51][color];

	gap = vt - v51;
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;

	ret = vt - (int)temp;
	//printk("[LCD] calc_v35_volt : ret : %d\n", ret);

	return ret;
}

static int calc_v51_volt(struct dim_data *data, int color)
{
	int gap;
	int vt, ret, v87, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V51][color];

	if (gamma > vreg_element_max[V51]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V51];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	vt = data->volt_vt[color];
	v87 = data->volt[TBL_INDEX_V87][color];

	gap = vt - v87;
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;

	ret = vt - (int)temp;
	//printk("[LCD] calc_v51_volt : ret : %d\n", ret);

	return ret;
}

static int calc_v87_volt(struct dim_data *data, int color)
{
	int gap;
	int vt, ret, v151, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V87][color];

	if (gamma > vreg_element_max[V87]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V87];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	vt = data->volt_vt[color];
	v151 = data->volt[TBL_INDEX_V151][color];
	//printk("[LCD] calc_v87_volt : vt : %d, v151 : %d\n", vt, v151);

	gap = vt - v151;
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;

	ret = vt - (int)temp;
	//printk("[LCD] calc_v87_volt : ret : %d\n", ret);

	return ret;
}

static int calc_v151_volt(struct dim_data *data, int color)
{
	int gap;
	int vt, ret, v203, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V151][color];

	if (gamma > vreg_element_max[V151]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V151];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	vt = data->volt_vt[color];
	v203 = data->volt[TBL_INDEX_V203][color];

	gap = vt - v203;
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;
	ret = vt - (int)temp;

	return ret;
}

static int calc_v203_volt(struct dim_data *data, int color)
{
	int gap;
	int vt, ret, v255, gamma;
	unsigned long temp;

	gamma = data->t_gamma[V203][color];

	if (gamma > vreg_element_max[V203]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V203];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	vt = data->volt_vt[color];
	v255 = data->volt[TBL_INDEX_V255][color];

	gap = vt - v255;
	temp = (unsigned long)gap * (unsigned long)v203_trans_volt[gamma];
	temp /= MULTIPLY_VALUE;
	ret = vt - (int)temp;

	return ret;
}

static int calc_v255_volt(struct dim_data *data, int color)
{
	int ret, gamma;

	gamma = data->t_gamma[V255][color];

	if (gamma > vreg_element_max[V255]) {
		pr_err("%s : gamma overflow : %d\n", __FUNCTION__, gamma);
		gamma = vreg_element_max[V255];
	}
	if (gamma < 0) {
		pr_err("%s : gamma undeflow : %d\n", __FUNCTION__, gamma);
		gamma = 0;
	}

	ret = (int)v255_trans_volt[gamma];

	return ret;
}

static int calc_inter_v1_v7(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v1, v7, ratio, temp;

	ratio = (int)int_tbl_v1_v7[gray];

	v1 = data->volt[TBL_INDEX_V1][color];
	v7 = data->volt[TBL_INDEX_V7][color];

	temp = (v1 - v7) * ratio;
	temp >>= 10;
	ret = v1 - temp;

	return ret;
}

static int calc_inter_v7_v11(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v7, v11, ratio, temp;

	ratio = (int)int_tbl_v7_v11[gray];
	v7 = data->volt[TBL_INDEX_V7][color];
	v11 = data->volt[TBL_INDEX_V11][color];

	temp = (v7 - v11) * ratio;
	temp >>= 10;
	ret = v7 - temp;
	//printk("[LCD] ret: %d\n", ret);

	return ret;
}

static int calc_inter_v11_v23(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v11, v23, ratio, temp;

	ratio = (int)int_tbl_v11_v23[gray];
	v11 = data->volt[TBL_INDEX_V11][color];
	v23 = data->volt[TBL_INDEX_V23][color];

	temp = (v11 - v23) * ratio;
	temp >>= 10;
	ret = v11 - temp;

	return ret;
}

static int calc_inter_v23_v35(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v23, v35, ratio, temp;

	ratio = (int)int_tbl_v23_v35[gray];
	v23 = data->volt[TBL_INDEX_V23][color];
	v35 = data->volt[TBL_INDEX_V35][color];

	temp = (v23 - v35) * ratio;
	temp >>= 10;
	ret = v23 - temp;

	return ret;
}

static int calc_inter_v35_v51(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v35, v51, ratio, temp;

	ratio = (int)int_tbl_v35_v51[gray];
	v35 = data->volt[TBL_INDEX_V35][color];
	v51 = data->volt[TBL_INDEX_V51][color];

	temp = (v35 - v51) * ratio;
	temp >>= 10;
	ret = v35 - temp;

	return ret;
}

static int calc_inter_v51_v87(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v51, v87, ratio, temp;

	ratio = (int)int_tbl_v51_v87[gray];
	v51 = data->volt[TBL_INDEX_V51][color];
	v87 = data->volt[TBL_INDEX_V87][color];

	temp = (v51 - v87) * ratio;
	temp >>= 10;
	ret = v51 - temp;

	return ret;
}

static int calc_inter_v87_v151(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v87, v151, ratio, temp;

	ratio = (int)int_tbl_v87_v151[gray];
	v87 = data->volt[TBL_INDEX_V87][color];
	v151 = data->volt[TBL_INDEX_V151][color];

	temp = (v87 - v151) * ratio;
	temp >>= 10;
	ret = v87 - temp;
	return ret;
}

static int calc_inter_v151_v203(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v151, v203, ratio, temp;

	ratio = (int)int_tbl_v151_v203[gray];
	v151 = data->volt[TBL_INDEX_V151][color];
	v203 = data->volt[TBL_INDEX_V203][color];

	temp = (v151 - v203) * ratio;
	temp >>= 10;
	ret = v151 - temp;

	return ret;
}

static int calc_inter_v203_v255(struct dim_data *data, int gray, int color)
{
	int ret = 0;
	int v203, v255, ratio, temp;

	ratio = (int)int_tbl_v203_v255[gray];
	v203 = data->volt[TBL_INDEX_V203][color];
	v255 = data->volt[TBL_INDEX_V255][color];

	temp = (v203 - v255) * ratio;
	temp >>= 10;
	ret = v203 - temp;

	return ret;
}

static int calc_reg_v1(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = DOUBLE_MULTIPLE_VREGOUT - data->look_volt[V1][color];
	t2 = DOUBLE_MULTIPLE_VREGOUT - data->look_volt[V7][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V1].de) / (unsigned long)t2;
	ret =  temp - fix_const[V1].nu;

	return ret;
}


static int calc_reg_v7(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = DOUBLE_MULTIPLE_VREGOUT - data->look_volt[V7][color];
	t2 = DOUBLE_MULTIPLE_VREGOUT - data->look_volt[V11][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V7].de) / (unsigned long)t2;
	ret =  temp - fix_const[V7].nu;

	return ret;
}


static int calc_reg_v11(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = data->volt_vt[color] - data->look_volt[V11][color];
	t2 = data->volt_vt[color] - data->look_volt[V23][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V11].de) / (unsigned long)t2;
	ret =  (int)temp - fix_const[V11].nu;

	return ret;

}

static int calc_reg_v23(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = data->volt_vt[color] - data->look_volt[V23][color];
	t2 = data->volt_vt[color] - data->look_volt[V35][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V23].de) / (unsigned long)t2;
	ret = (int)temp - fix_const[V23].nu;

	return ret;

}

static int calc_reg_v35(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = data->volt_vt[color] - data->look_volt[V35][color];
	t2 = data->volt_vt[color] - data->look_volt[V51][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V35].de)/ (unsigned long)t2;
	ret = (int)temp - fix_const[V35].nu;

	return ret;
}


static int calc_reg_v51(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = data->volt_vt[color] - data->look_volt[V51][color];
	t2 = data->volt_vt[color] - data->look_volt[V87][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V51].de) / (unsigned long)t2;
	ret = (int)temp - fix_const[V51].nu;

	return ret;
}


static int calc_reg_v87(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = data->volt_vt[color] - data->look_volt[V87][color];
	t2 = data->volt_vt[color] - data->look_volt[V151][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V87].de) / (unsigned long)t2;

	ret = (int)temp - fix_const[V87].nu;

	return ret;
}

static int calc_reg_v151(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = data->volt_vt[color] - data->look_volt[V151][color];
	t2 = data->volt_vt[color] - data->look_volt[V203][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V151].de) / (unsigned long)t2;
	ret = (int)temp - fix_const[V151].nu;

	return ret;
}



static int calc_reg_v203(struct dim_data *data, int color)
{
	int ret;
	int t1, t2;
	unsigned long temp;

	t1 = data->volt_vt[color] - data->look_volt[V203][color];
	t2 = data->volt_vt[color] - data->look_volt[V255][color];

	temp = ((unsigned long)t1 * (unsigned long)fix_const[V203].de) / (unsigned long)t2;
	ret = (int)temp - fix_const[V203].nu;

	return ret;
}

static int calc_reg_v255(struct dim_data *data, int color)
{
	int ret;
	int t1;
	unsigned long temp;

	t1 = DOUBLE_MULTIPLE_VREGOUT -  data->look_volt[V255][color];
	temp = ((unsigned long)t1 * (unsigned long)fix_const[V255].de) / DOUBLE_MULTIPLE_VREGOUT;
	ret = (int)temp - fix_const[V255].nu;

	return ret;
}

int s6e36w4x01_generate_volt_table(struct dim_data *data)
{
	int i, j;
	int seq, index, gray;
	int ret = 0;

	int calc_seq[NUM_VREF] = {V255, V203, V151, V87, V51, V35, V23, V11, V7, V1};
	int (*calc_volt_point[NUM_VREF])(struct dim_data *, int) = {
		calc_v1_volt,
		calc_v7_volt,
		calc_v11_volt,
		calc_v23_volt,
		calc_v35_volt,
		calc_v51_volt,
		calc_v87_volt,
		calc_v151_volt,
		calc_v203_volt,
		calc_v255_volt,
	};
	int (*calc_inter_volt[NUM_VREF])(struct dim_data *, int, int)  = {
		NULL,
		calc_inter_v1_v7,
		calc_inter_v7_v11,
		calc_inter_v11_v23,
		calc_inter_v23_v35,
		calc_inter_v35_v51,
		calc_inter_v51_v87,
		calc_inter_v87_v151,
		calc_inter_v151_v203,
		calc_inter_v203_v255,
	};

	for (i = 0; i < CI_MAX; i++)
		data->volt_vt[i] = calc_vt_volt(data->vt_mtp[i]);

	/* calculate voltage for V0 */
	for (i = 0; i < CI_MAX; i++)
		data->volt[0][i] = calc_v0_volt(data->v0_mtp[i]);

	/* calculate voltage for every vref point */
	for (j = 0; j < NUM_VREF; j++) {
		seq = calc_seq[j];
		index = vref_index[seq];
		if (calc_volt_point[seq] != NULL) {
			for (i = 0; i < CI_MAX; i++)
				data->volt[index][i] = calc_volt_point[seq](data ,i);
		}
	}

	index = 0;
	for (i = 0; i < MAX_GRADATION; i++) {
		if (i == vref_index[index]) {
			index++;
			continue;
		}
		gray = (i - vref_index[index - 1]) - 1;
		for (j = 0; j < CI_MAX; j++) {
			if (calc_inter_volt[index] != NULL) {
				data->volt[i][j] = calc_inter_volt[index](data, gray, j);
			}
		}

	}
#if defined (SMART_DIMMING_DEBUG)
	printk("=========================== VT Voltage ===========================\n");
	printk("R : %05d : G: %05d : B : %05d\n",
					data->volt_vt[0], data->volt_vt[1], data->volt_vt[2]);
	printk("\n=================================================================\n");
	for (i = 0; i < MAX_GRADATION; i++) {
		printk("V%03d R : %05d : G : %05d B : %05d\n", i,
					data->volt[i][CI_RED], data->volt[i][CI_GREEN], data->volt[i][CI_BLUE]);
	}
#endif
	return ret;
}

static int lookup_volt_index(struct dim_data *data, int gray)
{
	int ret, i;
	int temp;
	int index;
	int index_l, index_h, exit;
	int cnt_l, cnt_h;
	int p_delta, delta;

	temp = gray / (MULTIPLY_VALUE * MULTIPLY_VALUE);

	index = (int)lookup_tbl[temp];

	exit = 1;
	i = 0;
	while(exit) {
		index_l = temp - i;
		index_h = temp + i;
		if (index_l < 0)
			index_l = 0;
		if (index_h > MAX_BRIGHTNESS_COUNT)
			index_h = MAX_BRIGHTNESS_COUNT;
		cnt_l = (int)lookup_tbl[index] - (int)lookup_tbl[index_l];
		cnt_h = (int)lookup_tbl[index_h] - (int)lookup_tbl[index];

		if (cnt_l + cnt_h) {
			exit = 0;
		}
		i++;
	}

	p_delta = 0;
	index = (int)lookup_tbl[index_l];
	ret = index;

	temp = gamma_double_multi_tbl[index];
	//temp = gamma_multi_tbl[index] * MULTIPLY_VALUE;

	if (gray > temp)
		p_delta = gray - temp;
	else
		p_delta = temp - gray;

	for (i = 0; i <= (cnt_l + cnt_h); i++) {
		temp = gamma_double_multi_tbl[index + i];
		//temp = gamma_multi_tbl[index + i] * MULTIPLY_VALUE;
		if (gray > temp)
			delta = gray - temp;
		else
			delta = temp - gray;

		if (delta < p_delta) {
			p_delta = delta;
			ret = index + i;
		}
	}

	return ret;
}

int s6e36w4x01_cal_gamma_from_index(struct dim_data *data, struct SmtDimInfo *brInfo)
{
	int i, j;
	int ret = 0;
	int gray, index;
	long long gray_temp;
	signed int shift, c_shift;
	int gamma_int[NUM_VREF][CI_MAX];
	int br, temp;
	unsigned char *result;
	int (*calc_reg[NUM_VREF])(struct dim_data *, int)  = {
		calc_reg_v1,
		calc_reg_v7,
		calc_reg_v11,
		calc_reg_v23,
		calc_reg_v35,
		calc_reg_v51,
		calc_reg_v87,
		calc_reg_v151,
		calc_reg_v203,
		calc_reg_v255,
	};

	br = brInfo->refBr;

	result = brInfo->gamma;

	if (br > MAX_BRIGHTNESS_COUNT) {
		printk("Warning Exceed Max brightness : %d\n", br);
		br = MAX_BRIGHTNESS_COUNT;
	}
	for (i = V1; i < NUM_VREF; i++) {
		/* get reference shift value */
		if (brInfo->rTbl == NULL) {
			shift = 0;
		}
		else {
			shift = (signed int)brInfo->rTbl[i];
		}

		if (brInfo->br == MAX_GAMMA){
			gray = brInfo->cGma[vref_index[i]] * br;
			index = lookup_volt_index(data, gray);
		}else{
			gray_temp = (long long)brInfo->cGma[vref_index[i]] * br;
			gray = (int)(gray_temp / 1000);
			index = lookup_volt_index(data, gray);
		}
		index = index + shift;

		if (i == V1)
			index = 1;
		for (j = 0; j < CI_MAX; j++) {
			if (calc_reg[i] != NULL) {
				data->look_volt[i][j] = data->volt[index][j];
			}
		}
	}

	for (i = V1; i < NUM_VREF; i++) {
		for (j = 0; j < CI_MAX; j++) {
			if (calc_reg[i] != NULL) {
				index = (i * CI_MAX) + j;

				if (brInfo->cTbl == NULL)
					c_shift = 0;
				else
					c_shift = (signed int)brInfo->cTbl[index];

				temp = calc_reg[i](data, j);
				gamma_int[i][j] = (temp + c_shift) - data->mtp[i][j];

				if (gamma_int[i][j] >= vreg_element_max[i])
					gamma_int[i][j] = vreg_element_max[i];
				if (gamma_int[i][j] < 0)
					gamma_int[i][j] = 0;
			}
		}
	}

	index = 0;
	result[index++] = OLED_CMD_GAMMA;

	for (i = V255; i >= V1; i--) {
		if (i == V255) {
			result[index] = (gamma_int[i][CI_RED] > 0xff ? 1 : 0)<<2;
			result[index] |= (gamma_int[i][CI_GREEN] > 0xff ? 1 : 0)<<1;
			result[index++] |= (gamma_int[i][CI_BLUE] > 0xff ? 1 : 0)<<0;
		}
		for (j = 0; j < CI_MAX; j++) {
			//printk("%3d, ", gamma_int[i][j]);
			if (i == V255) {
				//result[index++] = gamma_int[i][j] > 0xff ? 1 : 0;
				result[index++] = gamma_int[i][j] & 0xff;
			} else
				result[index++] = (unsigned char)gamma_int[i][j];
		}
	}
		//printk("\n");
	result[index++] = 0x00;
	result[index++] = 0x00;

	return ret;
}

static int s6e36w4x01_dimming_alloc(struct s6e36w4x01 *lcd)
{
	int i, ret = 0;

	lcd->dimming = devm_kzalloc(lcd->dev, sizeof(*lcd->dimming), GFP_KERNEL);
	if (lcd->dimming == NULL) {
		pr_err("failed to allocate dimming.\n");
		ret = -ENOMEM;
		goto out;
	}

	for (i = 0; i < MAX_GAMMA_CNT; i++) {
		lcd->gamma_tbl[i] = (unsigned char *)
			kzalloc(sizeof(unsigned char) * GAMMA_CMD_CNT,
			GFP_KERNEL);
		if (lcd->gamma_tbl[i] == NULL) {
			pr_err("failed to allocate gamma_tbl\n");
			ret = -ENOMEM;
			goto out;
		}
	}
out:
	return ret;
}

static int set_gamma_to_center(struct SmtDimInfo *brInfo)
{
	int i, j;
	int ret = 0;
	unsigned int index = 0;
	unsigned char *result = brInfo->gamma;

	result[index++] = OLED_CMD_GAMMA;

	for (i = V255; i >= 0; i--) {
		for (j = 0; j < CI_MAX; j++) {
			if (i == V255) {
				result[index++] = (unsigned char)((center_gamma[i][j] >> 8) & 0x01);
				result[index++] = (unsigned char)center_gamma[i][j] & 0xff;
			}
			else {
				result[index++] = (unsigned char)center_gamma[i][j] & 0xff;
			}
		}
	}
	result[index++] = 0x00;
	result[index++] = 0x00;

	return ret;
}

static int set_gamma_to_hbm(struct SmtDimInfo *brInfo, struct dim_data *dimData, u8 * hbm)
{
	int ret = 0;
	unsigned int index = 0;
	unsigned char *result = brInfo->gamma;
	int i = 0;
	memset(result, 0, OLED_CMD_GAMMA_CNT);

	result[index++] = OLED_CMD_GAMMA;

	while (index < OLED_CMD_GAMMA_CNT) {
		if (((i >= 50) && (i < 65)) || ((i >= 68) && (i < 88)))
			result[index++] = hbm[i];
		i++;
	}
	for (i = 0; i < OLED_CMD_GAMMA_CNT; i++)
		dsim_info("%d : %d\n", i + 1, result[i]);
	return ret;
}

extern int s6e36w4x01_read_init_info(struct dsim_device *dsim, unsigned char *mtp, unsigned char *hbm);
int s6e36w4x01_init_dimming(struct dsim_device *dsim)
{
	struct panel_private *panel = &dsim->priv;
	struct SmtDimInfo *diminfo = NULL;
	struct lcd_device *lcd_d = dsim->ld;
	struct s6e36w4x01 *lcd = dev_get_drvdata(&lcd_d->dev);
	static struct dim_data *dimming = NULL;
	unsigned char mtp[S6E36W4_MTP_SIZE] = { 0, };
	unsigned char hbm[S6E36W4_HBMGAMMA_LEN] = { 0, };
	char string_buf[1024];
	int i, j, k;
	int pos = 0;
	int ret = 0;
	short temp;
	int method = 0;
	int string_offset;
#ifdef READ_MTP_ERR_VER2
	unsigned int errcnt = 0;
#endif
	bool read_err = true;

	lcd->br_map = (unsigned char *)&s6e36w4x01_br_tbl[0];

	ret = s6e36w4x01_dimming_alloc(lcd);
	if (ret) {
		pr_err("%s: failed to allocate s6e36w4x01 structure.\n", __func__);
		ret = -ENOMEM;
		goto error;
	}

	ret = s6e36w4x01_read_init_info(dsim, mtp, hbm);
	if (ret)
		pr_err("%s : failed to generate gamma tablen\n", __func__);

	if (dimming == NULL) {
		dimming = (struct dim_data *)kmalloc(sizeof(struct dim_data), GFP_KERNEL);
		if (!dimming) {
			dsim_err("failed to allocate memory for dim data\n");
			ret = -ENOMEM;
			goto error;
		}
	}

	diminfo = (void *)s6e36w4x01_dimming_info;
	panel->dim_data = (void *)dimming;
	panel->dim_info = (void *)diminfo;

#ifdef READ_MTP_ERR_VER2
	for (i = 0; i <  S6E36W4_MTP_SIZE; i++) {
		if (mtp[i])
			read_err = false;
		if (mtp[i] == 0xff)
			errcnt++;
	}
	if (errcnt > 5)
		read_err = true;
#else
	for (i = 0; i <  S6E36W4_MTP_SIZE; i++) {
		if (mtp[i])
			read_err = false;
	}
#endif
	if (read_err) {
		dsim_info("%s: Wrong MTP offset! Use default one. \n", __func__);
		for (i = 0; i <  S6E36W4_MTP_SIZE; i++)
			mtp[i] = mtp_default[i];
	}

	for (j = 0; j < CI_MAX; j++) {
		pos += 1;
		temp = ((mtp[0] & (0x01<<(2-j))) ? -1 : 1) * mtp[pos];
		dimming->t_gamma[V255][j] = (int)center_gamma[V255][j] + temp;
		dimming->mtp[V255][j] = temp;
	}
	pos += 1;

	for (i = V203; i >= 0; i--) {
		for (j = 0; j < CI_MAX; j++) {
			temp = ((mtp[pos] & 0x80) ? -1 : 1) * (mtp[pos] & 0x7f);
			dimming->t_gamma[i][j] = (int)center_gamma[i][j] + temp;
			dimming->mtp[i][j] = temp;
			pos++;
		}
	}

	/* for v0 */
	temp = ((mtp[pos] & 0xF0) >> 4) | ((mtp[pos] & 0x0F) << 4) | ((mtp[pos + 1] & 0xF0) << 4);
	for (i = 0; i < CI_MAX; i++) {
		dimming->v0_mtp[i] = (temp >> (i * 4)) & 0x0f;
	}

	pos++;
	/* for vt */
	temp = (mtp[pos] & 0x0F) | (mtp[pos + 1] & 0xF0) | ((mtp[pos + 1] & 0x0F) << 8);  // B, G, R

	for (i = 0; i < CI_MAX; i++) {
		dimming->vt_mtp[i] = (temp >> (i * 4)) & 0x0f;
	}

#ifdef SMART_DIMMING_DEBUG
	dsim_info("Center Gamma Info : \n");
	for (i = 0; i < VMAX; i++) {
		dsim_info("Gamma : %3d %3d %3d : %3x %3x %3x\n",
			  dimming->t_gamma[i][CI_RED], dimming->t_gamma[i][CI_GREEN], dimming->t_gamma[i][CI_BLUE],
			  dimming->t_gamma[i][CI_RED], dimming->t_gamma[i][CI_GREEN], dimming->t_gamma[i][CI_BLUE]);
	}

#endif
	dsim_info("%s:mtp[%4d %4d %4d]\n", __func__,
		  dimming->vt_mtp[CI_RED], dimming->vt_mtp[CI_GREEN], dimming->vt_mtp[CI_BLUE]);
	dsim_info("%s:mtp[%4d %4d %4d]\n", __func__,
		  dimming->v0_mtp[CI_RED], dimming->v0_mtp[CI_GREEN], dimming->v0_mtp[CI_BLUE]);

	for (i = 0; i < VMAX; i++) {
		dsim_info("%s:mtp[%4d %4d %4d]\n", __func__,
			  dimming->mtp[i][CI_RED], dimming->mtp[i][CI_GREEN], dimming->mtp[i][CI_BLUE]);
	}

	ret = s6e36w4x01_generate_volt_table(dimming);
	if (ret) {
		dsim_info("[ERR:%s] failed to generate volt table\n", __func__);
		goto error;
	}

	for (i = 0; i < MAX_BR_INFO; i++) {
		method = diminfo[i].way;

		if (method == DIMMING_METHOD_FILL_CENTER) {
			ret = set_gamma_to_center(&diminfo[i]);
			if (ret) {
				dsim_err("%s : failed to get center gamma\n", __func__);
				goto error;
			}
		}
		else if (method == DIMMING_METHOD_FILL_HBM) {
			ret = set_gamma_to_hbm(&diminfo[i], dimming, hbm);
			if (ret) {
				dsim_err("%s : failed to get hbm gamma\n", __func__);
				goto error;
			}
		}
	}

	for (i = 0; i < MAX_BR_INFO; i++) {
		method = diminfo[i].way;
		if (method == DIMMING_METHOD_AID) {
			ret = s6e36w4x01_cal_gamma_from_index(dimming, &diminfo[i]);
			if (ret) {
				dsim_err("%s : failed to calculate gamma : index : %d\n", __func__, i);
				goto error;
			}
		}
	}

	for (i = 0; i < (MAX_BR_INFO); i++) {
		memset(string_buf, 0, sizeof(string_buf));
		string_offset = sprintf(string_buf, "gamma[%3d] : ", diminfo[i].br);

		for (j = 0; j < GAMMA_CMD_CNT; j++){
			string_offset += sprintf(string_buf + string_offset, "%3d ", diminfo[i].gamma[j]);
			s6e36w4x01_gamma_set[i][j] = diminfo[i].gamma[j];
		}
#ifdef SMART_DIMMING_DEBUG
		dsim_info("[LCD]%s\n", string_buf);
#endif
	}

	for (k = 0; k < GAMMA_CMD_CNT; k++){
		diminfo[73].gamma[k] = MAX_GAMMA_SET[k];
		string_offset += sprintf(string_buf + string_offset, "%3d ", diminfo[73].gamma[k]);
		s6e36w4x01_gamma_set[73][k] = diminfo[73].gamma[k];
	}

	lcd->lpm_br_max = LPM_BR_MAX_INDEX;
	lcd->lpm_br_normal = LPM_BR_NORMAL_INDEX;
	lcd->lpm_br_min = LPM_BR_MIN_INDEX;
	lcd->lpm_br_charging = LPM_BR_CHARGING_INDEX;

#ifdef SMART_DIMMING_DEBUG
	dsim_info("[LCD]%s\n", string_buf);
#endif
error:
	return ret;

}

#define MAX_DIMMING_TABLE	3
#define DIMMING_TABLE_PRINT_SIZE	19
static int dim_table_num = 0;
ssize_t s6e36w4x01_dimming_table_store(struct device *dev,
				struct device_attribute *attr, const char *buf,
				size_t size)
{
	struct s6e36w4x01 *lcd = dev_get_drvdata(dev);
	unsigned char value;
	int rc;

	rc = kstrtou8(buf, 0, &value);
	if (rc < 0) {
		dev_err(lcd->dev, "%s: failed to read parameter value\n", __func__);
		return -EIO;
	}

	if (value > MAX_DIMMING_TABLE) {
		dev_err(lcd->dev, "%s: Invalid value. [%d]\n", __func__, value);
		return -EIO;
	}

	dim_table_num = value;
	dev_info(lcd->dev, "%s: dimming_table[%d]\n", __func__, dim_table_num);

	return size;
}

ssize_t s6e36w4x01_dimming_table_show(struct device *dev,
				struct device_attribute *attr, char *buf)
{
	char buffer[DEFAULT_BUFF_SIZE];
	int ret = 0;
	int i = 0, j = 0;
	int max_cnt = DIMMING_TABLE_PRINT_SIZE;

	if (dim_table_num == 0) {
		i = 0;
		max_cnt = DIMMING_TABLE_PRINT_SIZE;
	} else if (dim_table_num == 1) {
		i = DIMMING_TABLE_PRINT_SIZE;
		max_cnt = DIMMING_TABLE_PRINT_SIZE * 2;
	} else if (dim_table_num == 2)  {
		i = DIMMING_TABLE_PRINT_SIZE * 2;
		max_cnt = DIMMING_TABLE_PRINT_SIZE * 3;
	} else if (dim_table_num ==3) {
		i = DIMMING_TABLE_PRINT_SIZE * 3;
		max_cnt = MAX_GAMMA_CNT;
	}

	for (; i < max_cnt; i++) {
		ret += scnprintf(buffer, DEFAULT_BUFF_SIZE, "[%3d] ", s6e36w4x01_dimming_info[i].br);
		strncat(buf, buffer, DEFAULT_BUFF_SIZE);

		for(j =2; j < GAMMA_CMD_CNT ; j++) {
				ret += scnprintf(buffer, DEFAULT_BUFF_SIZE, "%3d ", s6e36w4x01_gamma_set[i][j]);
				strncat(buf, buffer, DEFAULT_BUFF_SIZE);
		}
		strncat(buf, "\n", strlen("\n"));
		ret += strlen("\n");
	}

	return ret;
}
